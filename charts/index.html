<html>
<head>
	<title>Charts</title>
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.0.0.min.js"></script>
	<script type="text/javascript">
	function init() {
		$.ajax({
		  url: "tablet-ips.json"
		}).done(function(data) {
			console.log(data);
			setInterval(function() {
				$('#imgCpu').attr('src', buildUrl("cpu-0.cpu-user", data));
				$('#imgMem').attr('src', buildUrl("memory.memory-used", data));
			}, 3000);
		});
	}
	
	function buildUrl(metric, data) {
		var url = "http://54.237.32.187/render/";
		url += "?width=586";
		url += "&height=308";
		url += "&_salt=" + Math.random();
		url += "&from=-1h";
		for(var i = 0; i < data.length; i++) {
			var dns = data[i].replace(/\./g, "_");
			url += "&target=collectd." + dns + "." + metric;
		}
		return url;
	}
	</script>
</head>
<body onload="init()">
        <img id="imgCpu" />
        <img id="imgMem" />
</body>
